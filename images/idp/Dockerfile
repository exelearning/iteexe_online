FROM ubuntu:16.04

RUN apt-get update && apt-get -yq install simplesamlphp subversion

RUN a2enconf simplesamlphp

RUN phpenmod mcrypt

RUN cd /usr/share/simplesamlphp/modules && svn export https://github.com/sylvainmed/simplesamlphp/trunk/modules/authgoogle

RUN touch /usr/share/simplesamlphp/modules/openid/enable

ADD Google.php /usr/share/simplesamlphp/modules/authgoogle/lib/Auth/Source/Google.php

ADD run.sh /run.sh

RUN chmod 755 /*.sh

CMD /run.sh
